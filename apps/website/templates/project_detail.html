{% extends "base.html" %}

{% block content %}
    <div class="fixed-content">
        <h1>Project #{{ project.id }}: {{ project.title }}</h1>
        
        <table class="horizontal">
            <tbody>
                <tr>
                    <th>ID</th>
                    <td class="mono">{{ project.id }}</td>
                </tr>
                <tr>
                    <th>Title</th>
                    <td class="emphasis">{{ project.title }}</td>
                </tr>
                {% if project.goal %}
                <tr>
                    <th>Goal</th>
                    <td>{{ project.goal }}</td>
                </tr>
                {% endif %}
                <tr>
                    <th>Status</th>
                    <td>
                        {{ project.get_status_display }}
                    </td>
                </tr>
                <tr>
                    <th>Created</th>
                    <td>{{ project.created_at|date:"Y-m-d H:i" }}</td>
                </tr>
                <tr>
                    <th>Last Updated</th>
                    <td>{{ project.updated_at|date:"Y-m-d H:i" }}</td>
                </tr>
                <tr>
                    <th>Tasks</th>
                    <td>
                        {{ tasks|length }} total
                        {% if tasks %}
                            {% regroup tasks by is_done as task_groups %}
                            {% for group in task_groups %}
                                {% if group.grouper %}
                                    ({{ group.list|length }} completed)
                                {% endif %}
                            {% endfor %}
                        {% endif %}
                    </td>
                </tr>
            </tbody>
        </table>

        <h2>Change Project Status</h2>
        <form method="post" action="{% url 'project_detail_page.actions.update_status' project.id %}">
            {% csrf_token %}
            <table class="form">
                <tbody>
                    <tr>
                        <th>{{ status_form.status.label_tag }}</th>
                        <td>
                            {{ status_form.status }}
                        </td>
                    </tr>
                </tbody>
            </table>
            <button type="submit">Update Status</button>
        </form>
    </div>
{% endblock %}